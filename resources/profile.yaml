name: "keystone"
dry-run: false
provision: false
test: true
log-script: true
throw: false
timestamp: 1439379240015
tests:
       - - name: "Smoke test"
           description: "Automated script for pinging Spock to make sure the server responds" 
           invocation: "$OPSC_REPO_HOME/spock/test/functional/smoke-test.sh $jb_opsc_IP_ADDR_0"
           #skip: true
         - name: "A different smoke test"
           description: "Automated script for pinging Spock to make sure the server responds" 
           invocation: "$OPSC_REPO_HOME/spock/test/functional/smoke-test.py $jb_opsc_IP_ADDR_0"
           skip: true
       - - invocation: "$OPSC_REPO_HOME/spock/test/functional/6238-test-demo-pathway.py $jb_opsc_IP_ADDR_0"
           description: "Happy path (from nothing)"
           name: "Happy path 1"
clusters:
        - cluster-name: "jb-opsc"
          num-nodes: 1
          force: true
          #skip: true
          post-launch: null
          products:
                  - product: "opscenter"
                    version-or-branch: "spocklib"
                    install-type: "source"
                    start: true
                    post-install: null
                    post-start:
                            - 0: |
                                    mkdir -p ~/.spock/ca
                                    export SPOCK_DB=~/.spock/spock.db
                                    export SPOCK_CA_DIR=~/.spock/ca
                                    cd ripcord/spock
                                    lein run db migrate && lein uberjar
                                    start-stop-daemon --start --name spock --background --exec /bin/bash -- \
                                    -c "export SPOCK_CA_DIR=~/.spock/ca && export SPOCK_DB=~/.spock/spock.db &&
                                    cd ~/ripcord/spock && java -jar ./target/spock-0.1.0-SNAPSHOT-standalone.jar http serve"
                                    sleep 10

